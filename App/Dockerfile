# ==============================
# ğŸ§± Stage 1: Build á»©ng dá»¥ng báº±ng Maven
# ==============================
FROM maven:3.9.4-eclipse-temurin-17 AS build
WORKDIR /app

# Copy toÃ n bá»™ source code (bao gá»“m pom.xml, src, v.v.)
COPY . .

# Build project, bá» qua test Ä‘á»ƒ nhanh hÆ¡n
RUN mvn clean package -DskipTests

# ==============================
# ğŸš€ Stage 2: Cháº¡y á»©ng dá»¥ng
# ==============================
FROM eclipse-temurin:17-jdk-jammy
WORKDIR /app

# Copy file jar Ä‘Ã£ build tá»« stage trÆ°á»›c
COPY --from=build /app/target/*.jar app.jar

# Má»Ÿ cá»•ng 8080 Ä‘á»ƒ Spring Boot láº¯ng nghe
EXPOSE 8080

# Cháº¡y á»©ng dá»¥ng Spring Boot
ENTRYPOINT ["java", "-jar", "app.jar"]
